<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluss vs. Kafka: An Interactive Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Slate/Neutral background, Sky accent) -->
    <!-- Application Structure Plan: The SPA uses a thematic, single-page structure with a top navigation bar for smooth scrolling. This design breaks down the dense technical report into manageable, explorable sections (Comparison, Advantages, Deep Dive, Architecture), which is more user-friendly than a linear document. Key interactions like toggles and tabs are used within sections to present complex comparisons without overwhelming the user, guiding them from the 'why' (advantages) to the 'how' (deep dive) and finally the 'impact' (architecture). -->
    <!-- Visualization & Content Choices:
        - Core Differences: Goal: Compare -> Method: Styled HTML columns -> Interaction: Static, clear layout for foundational knowledge.
        - Projection Pushdown: Goal: Compare Performance -> Method: Chart.js Bar Chart -> Interaction: Toggle updates chart data dynamically to visually prove the performance gain.
        - Flink Join State: Goal: Organize/Compare Architectures -> Method: HTML/CSS Diagram -> Interaction: Toggle switches between "Before" and "After" diagrams to highlight the architectural simplification.
        - Architecture Transformation: Goal: Compare -> Method: Large HTML/CSS Diagrams -> Interaction: Toggle to visualize the overall impact on the data stack.
        - Stream/Table Duality: Goal: Inform -> Method: HTML/CSS animated diagram -> Interaction: Play button animates events to show the concept in action.
        - Time Travel: Goal: Show Change -> Method: HTML/CSS timeline -> Interaction: Clicking timeline points updates a data view to demonstrate historical state retrieval.
        - All choices avoid SVG/Mermaid, using Canvas for charts and structured HTML/CSS for diagrams. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .nav-link {
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .active-nav {
            color: #0284c7;
            border-bottom-color: #0284c7;
        }
        .tab-btn {
            transition: all 0.3s ease;
        }
        .active-tab {
            background-color: #0284c7;
            color: white;
        }
        .diagram-arrow {
            position: relative;
            width: 100%;
            height: 2px;
            background-color: #64748b;
            margin: 2rem 0;
        }
        .diagram-arrow::after {
            content: '';
            position: absolute;
            right: -1px;
            top: -4px;
            border: solid #64748b;
            border-width: 0 2px 2px 0;
            display: inline-block;
            padding: 5px;
            transform: rotate(-45deg);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <h1 class="text-xl font-bold text-sky-600">Fluss äº¤äº’å¼å­¦ä¹ æŒ‡å—</h1>
            <div class="hidden md:flex space-x-8 text-sm font-medium text-slate-600">
                <a href="#comparison" class="nav-link border-b-2 border-transparent hover:text-sky-600">æ ¸å¿ƒå¯¹æ¯”</a>
                <a href="#advantages" class="nav-link border-b-2 border-transparent hover:text-sky-600">ä¸‰å¤§ä¼˜åŠ¿</a>
                <a href="#deep-dive" class="nav-link border-b-2 border-transparent hover:text-sky-600">åº•å±‚åŸç†</a>
                <a href="#paradigm-shift" class="nav-link border-b-2 border-transparent hover:text-sky-600">æ¶æ„èŒƒå¼</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">

        <section id="intro" class="text-center min-h-[60vh] flex flex-col justify-center items-center">
            <h2 class="text-4xl md:text-6xl font-bold tracking-tight">ä¸€åœºæ•°æ®æ¶æ„çš„<span class="text-sky-600">èŒƒå¼è½¬ç§»</span></h2>
            <p class="mt-6 max-w-3xl text-lg text-slate-600">
                æœ¬æ–‡æ¡£å°†é€šè¿‡äº¤äº’å¼çš„æ–¹å¼ï¼Œå¸¦æ‚¨æ·±å…¥äº†è§£æ–°ä¸€ä»£æµå¼å­˜å‚¨ç³»ç»Ÿ **Fluss** å¦‚ä½•åœ¨æ€§èƒ½ã€æ¶æ„å’Œæ•°æ®ä¸€è‡´æ€§ä¸Šè¶…è¶Šä¼ ç»Ÿæ ‡æ† **Kafka**ï¼Œå¼€å¯ç°ä»£æ•°æ®æ ˆçš„æ–°ç¯‡ç« ã€‚
            </p>
            <a href="#comparison" class="mt-8 px-6 py-3 bg-sky-600 text-white font-semibold rounded-lg shadow-md hover:bg-sky-700 transition-colors">å¼€å§‹æ¢ç´¢</a>
        </section>

        <section id="comparison" class="py-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold">æ ¸å¿ƒå¯¹æ¯”ï¼šç®¡é“ vs. æ™ºèƒ½ä»“åº“</h2>
                <p class="mt-2 text-slate-500">ä»ä¸¤ä¸ªæ ¸å¿ƒç»´åº¦ï¼Œçœ‹æ¸… Fluss ä¸ Kafka çš„æœ¬è´¨åŒºåˆ«ã€‚</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-2xl font-bold text-slate-500">Apache Kafka</h3>
                    <p class="mt-2 text-sm text-slate-400">åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°</p>
                    <div class="mt-6 space-y-4">
                        <div class="flex items-start">
                            <span class="text-sky-500 mr-3 mt-1">â–¶</span>
                            <div>
                                <h4 class="font-semibold">å®šä½ï¼šæ—¥å¿—ç®¡é“</h4>
                                <p class="text-sm text-slate-600">é«˜ååé‡çš„æ•°æ®ç®¡é“ï¼Œç”¨äºç³»ç»Ÿè§£è€¦å’Œå®æ—¶æ•°æ®ç¼“å†²ã€‚</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="text-sky-500 mr-3 mt-1">â–¶</span>
                            <div>
                                <h4 class="font-semibold">æ¶æ„ï¼šè¡Œå¼å­˜å‚¨ (Row-based)</h4>
                                <p class="text-sm text-slate-600">æ•°æ®ä»¥è¡Œä¸ºå•ä½è¿½åŠ å­˜å‚¨ï¼Œè¯»å–æ—¶éœ€åŠ è½½å¹¶ä¼ è¾“æ•´è¡Œæ•°æ®ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-sky-600 text-white p-8 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-bold">Apache Fluss</h3>
                    <p class="mt-2 text-sm text-sky-200">ä¸ºå®æ—¶åˆ†æè€Œç”Ÿçš„æµå¼å­˜å‚¨</p>
                     <div class="mt-6 space-y-4">
                        <div class="flex items-start">
                            <span class="text-sky-200 mr-3 mt-1">â–¶</span>
                            <div>
                                <h4 class="font-semibold">å®šä½ï¼šæ™ºèƒ½åŒ–çš„æ•°æ®ä»“åº“åº•åº§</h4>
                                <p class="text-sm text-sky-100">ä¸€ä¸ªå¯æŸ¥è¯¢ã€æœ‰ç»“æ„ã€ä¸ºåˆ†æè€Œä¼˜åŒ–çš„å­˜å‚¨ç³»ç»Ÿã€‚</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="text-sky-200 mr-3 mt-1">â–¶</span>
                            <div>
                                <h4 class="font-semibold">æ¶æ„ï¼šåˆ—å¼å­˜å‚¨ (Columnar Storage)</h4>
                                <p class="text-sm text-sky-100">æ•°æ®æŒ‰åˆ—ç»„ç»‡ï¼Œå¯æŒ‰éœ€è¯»å–ç‰¹å®šåˆ—ï¼Œæ˜¯å…¶ä¼—å¤šä¼˜åŠ¿çš„æ ¹æºã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="advantages" class="py-20 bg-white rounded-2xl">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold">Fluss çš„ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿</h2>
                <p class="mt-2 text-slate-500">æ¢ç´¢ Fluss å¦‚ä½•åœ¨æ€§èƒ½ã€æ¶æ„å’Œä¸€è‡´æ€§ä¸Šå®ç°çªç ´ã€‚</p>
            </div>

            <div class="max-w-5xl mx-auto">
                <div class="mb-4 flex justify-center border-b border-slate-200">
                    <button data-tab="performance" class="tab-btn px-6 py-3 font-medium text-slate-600 active-tab">ğŸš€ æ€§èƒ½ä¼˜åŠ¿</button>
                    <button data-tab="architecture" class="tab-btn px-6 py-3 font-medium text-slate-600">ğŸ›ï¸ æ¶æ„ä¼˜åŠ¿</button>
                    <button data-tab="consistency" class="tab-btn px-6 py-3 font-medium text-slate-600">ğŸ”— ä¸€è‡´æ€§ä¼˜åŠ¿</button>
                </div>

                <div id="tab-content" class="p-4">
                    <div id="performance" class="tab-panel space-y-16">
                        <!-- Projection Pushdown -->
                        <div>
                            <h4 class="text-xl font-bold text-center">ä¼˜åŠ¿ä¸€ï¼šæŠ•å½±ä¸‹æ¨ (Projection Pushdown)</h4>
                            <p class="text-center mt-2 text-slate-600">åªè¯»å–ä½ éœ€è¦çš„æ•°æ®ï¼Œæ•°å€æå‡åˆ†ææ€§èƒ½ã€‚</p>
                            <div class="mt-8">
                                <div class="flex justify-center items-center mb-4">
                                    <span class="mr-3 font-medium">æŸ¥è¯¢æ¨¡å¼:</span>
                                    <div class="bg-slate-200 p-1 rounded-lg flex items-center">
                                        <button id="pp-kafka-btn" class="px-4 py-1 text-sm font-semibold rounded-md bg-white shadow">Kafka (å…¨é‡è¯»å–)</button>
                                        <button id="pp-fluss-btn" class="px-4 py-1 text-sm font-semibold rounded-md ">Fluss (æŒ‰éœ€è¯»å–)</button>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="projectionPushdownChart"></canvas>
                                </div>
                                <p id="pp-explanation" class="text-center mt-4 text-sm text-slate-500 w-full max-w-2xl mx-auto">åœ¨ Kafka æ¨¡å¼ä¸‹ï¼Œå³ä½¿æŸ¥è¯¢åªéœ€è¦2ä¸ªå­—æ®µï¼Œä¹Ÿå¿…é¡»ä¼ è¾“åŒ…å«100ä¸ªå­—æ®µçš„å…¨éƒ¨æ•°æ®ã€‚</p>
                            </div>
                        </div>
                        
                        <!-- Flink Join -->
                        <div>
                             <h4 class="text-xl font-bold text-center">ä¼˜åŠ¿äºŒï¼šè§£å†³ Flink åŒæµ Join å¤§çŠ¶æ€é—®é¢˜</h4>
                             <p class="text-center mt-2 text-slate-600">å°†çŠ¶æ€ç®¡ç†ä¸‹æ”¾ç»™Flussï¼Œè®© Flink å›å½’çº¯ç²¹è®¡ç®—ã€‚</p>
                             <div class="mt-8">
                                 <div class="flex justify-center items-center mb-6">
                                     <span class="mr-3 font-medium">Join æ¶æ„:</span>
                                     <div class="bg-slate-200 p-1 rounded-lg flex items-center">
                                         <button id="join-flink-btn" class="px-4 py-1 text-sm font-semibold rounded-md bg-white shadow">ä¼ ç»ŸåŒæµJoin</button>
                                         <button id="join-fluss-btn" class="px-4 py-1 text-sm font-semibold rounded-md">Fluss Lookup Join</button>
                                     </div>
                                 </div>
                                 <div id="join-diagram-container" class="max-w-3xl mx-auto p-4 flex justify-center items-center min-h-[250px] transition-all duration-500">
                                     <!-- Diagram will be injected here -->
                                 </div>
                             </div>
                        </div>
                    </div>
                    <div id="architecture" class="tab-panel hidden">
                        <h4 class="text-xl font-bold text-center">ä¼˜åŠ¿ï¼šä»â€œå¤æ‚ç»„åˆâ€åˆ°â€œä¼˜é›…ç»Ÿä¸€â€</h4>
                        <p class="text-center mt-2 text-slate-600">ç”¨ä¸€ä¸ªç³»ç»Ÿæ›¿ä»£å¤šä¸ªç»„ä»¶ï¼Œå¤§å¹…ç®€åŒ–æŠ€æœ¯æ ˆã€‚</p>
                        <div class="mt-8 grid md:grid-cols-2 gap-8 items-center">
                           <div class="border-2 border-dashed border-red-400 p-6 rounded-lg">
                                <h5 class="text-lg font-bold text-center text-red-600">ä¼ ç»Ÿ Lambda/Kappa æ¶æ„</h5>
                                <div class="mt-4 space-y-3 text-sm">
                                    <div class="bg-red-100 p-2 rounded text-center font-medium">Kafka (æ¶ˆæ¯é˜Ÿåˆ—)</div>
                                    <div class="text-center">â†“</div>
                                    <div class="bg-red-100 p-2 rounded text-center font-medium">Flink (è®¡ç®—)</div>
                                    <div class="flex justify-around text-center">
                                        <div class="flex flex-col items-center">
                                           <span>â†˜</span>
                                           <div class="bg-red-100 p-2 rounded mt-1">Redis/HBase (åœ¨çº¿æŸ¥è¯¢)</div>
                                        </div>
                                        <div class="flex flex-col items-center">
                                           <span>â†™</span>
                                           <div class="bg-red-100 p-2 rounded mt-1">HDFS/S3 (ç¦»çº¿å­˜å‚¨)</div>
                                        </div>
                                    </div>
                                    <p class="mt-4 text-xs text-red-700">ç—›ç‚¹ï¼šæ¶æ„å¤æ‚ã€è¿ç»´æˆæœ¬é«˜ã€å¤šä»½æ•°æ®å‰¯æœ¬å¯¼è‡´ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
                                </div>
                           </div>
                           <div class="border-2 border-green-500 bg-green-50 p-6 rounded-lg">
                                <h5 class="text-lg font-bold text-center text-green-700">Fluss æ–°æ¶æ„</h5>
                                <div class="mt-4 space-y-3 text-sm">
                                    <div class="bg-green-200 p-2 rounded text-center font-medium">æ•°æ®æº</div>
                                    <div class="text-center">â†“</div>
                                    <div class="bg-green-200 p-2 rounded text-center font-medium">Fluss (ç»Ÿä¸€å­˜å‚¨)</div>
                                    <div class="text-center">â†“</div>
                                    <div class="bg-green-200 p-2 rounded text-center font-medium">Flink (å¯æµå¯æ‰¹)</div>
                                    <div class="text-center">â†“</div>
                                    <div class="bg-green-200 p-2 rounded text-center font-medium">ç»Ÿä¸€è§†å›¾ (æŠ¥è¡¨/åº”ç”¨)</div>
                                    <p class="mt-4 text-xs text-green-800">ä¼˜åŠ¿ï¼šæ¶æ„ç®€åŒ–ã€æˆæœ¬é™ä½ã€å•ä¸€æ•°æ®æºä¿è¯ä¸€è‡´æ€§ã€‚</p>
                                </div>
                           </div>
                        </div>
                    </div>
                    <div id="consistency" class="tab-panel hidden">
                        <h4 class="text-xl font-bold text-center">ä¼˜åŠ¿ï¼šç»ˆç»“å®æ—¶ä¸ç¦»çº¿çš„â€œæ•°æ®åˆ†è£‚â€</h4>
                        <p class="text-center mt-2 text-slate-600">é€šè¿‡â€œå•ä¸€æ•°æ®æºâ€å®ç°å®æ—¶ä¸ç¦»çº¿æ•°æ®çš„åŸç”Ÿä¸€è‡´ã€‚</p>
                        <div class="mt-8 max-w-4xl mx-auto">
                            <div class="grid md:grid-cols-2 gap-8 text-center">
                                <div>
                                    <h5 class="font-bold">ä¼ ç»Ÿ Lambda æ¶æ„</h5>
                                    <div class="mt-4 p-4 border rounded-lg">
                                        <p>æ•°æ®æº</p>
                                        <div class="flex justify-around mt-2">
                                            <div class="flex flex-col items-center">
                                                <div class="h-10 border-l border-slate-400"></div>
                                                <p class="text-sm text-sky-600">å®æ—¶é“¾è·¯</p>
                                            </div>
                                            <div class="flex flex-col items-center">
                                                <div class="h-10 border-l border-slate-400"></div>
                                                <p class="text-sm text-orange-600">ç¦»çº¿é“¾è·¯</p>
                                            </div>
                                        </div>
                                        <p class="text-red-500 mt-4 text-sm font-semibold">ç»“æœå¯èƒ½ä¸ä¸€è‡´ âŒ</p>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="font-bold">Fluss ç»Ÿä¸€æ¶æ„</h5>
                                    <div class="mt-4 p-4 border rounded-lg bg-slate-50">
                                        <p>Fluss (å•ä¸€æ•°æ®æº)</p>
                                        <div class="flex justify-center mt-2">
                                            <div class="flex flex-col items-center">
                                                <div class="h-10 border-l border-slate-400"></div>
                                                <p class="text-sm text-green-600">ç»Ÿä¸€è®¡ç®— (Flink)</p>
                                            </div>
                                        </div>
                                        <p class="text-green-600 mt-4 text-sm font-semibold">ç»“æœåŸç”Ÿä¸€è‡´ âœ…</p>
                                    </div>
                                </div>
                            </div>
                            <p class="mt-8 text-center text-slate-600">æ— è®ºæ˜¯å®æ—¶å¤§å±è¿˜æ˜¯ç¦»çº¿æŠ¥è¡¨ï¼Œéƒ½æºè‡ªåŒä¸€ä»½æ•°æ®ã€åŒä¸€å¥—é€»è¾‘ï¼Œä»æ¶æ„è®¾è®¡ä¸Šæ ¹æ²»äº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="deep-dive" class="py-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold">æ­ç§˜åº•å±‚åŸç†</h2>
                <p class="mt-2 text-slate-500">ç†è§£æ”¯æ’‘ Fluss å¼ºå¤§ä¼˜åŠ¿çš„ä¸¤å¤§åŸºçŸ³æ¦‚å¿µã€‚</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12 max-w-6xl mx-auto">
                <!-- Stream-Table Duality -->
                <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-2xl font-bold text-center">1. æµè¡¨äºŒå…ƒæ€§</h3>
                    <p class="text-center text-sm mt-2 text-slate-500">ä»»ä½•æ•°æ®éƒ½å¯ä»¥åŒæ—¶è¢«è§†ä¸ºâ€œæµâ€å’Œâ€œè¡¨â€ã€‚</p>
                    <div class="mt-6">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center">
                                <h4 class="font-semibold">æµ (Stream)</h4>
                                <p class="text-xs text-slate-400">å˜æ›´äº‹ä»¶æ—¥å¿—</p>
                                <ul id="stream-events" class="mt-2 text-left text-sm space-y-1 p-2 bg-slate-50 rounded-md h-48 overflow-y-auto">
                                </ul>
                            </div>
                             <div class="text-center">
                                <h4 class="font-semibold">è¡¨ (Table)</h4>
                                <p class="text-xs text-slate-400">å½“å‰æœ€æ–°çŠ¶æ€</p>
                                <div id="table-state" class="mt-2 text-left text-sm space-y-1 p-2 bg-slate-50 rounded-md h-48 overflow-y-auto">
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-4">
                            <button id="play-duality-btn" class="px-4 py-2 bg-sky-600 text-white font-semibold rounded-md hover:bg-sky-700 transition-colors text-sm">â–¶ æ’­æ”¾åŠ¨ç”»</button>
                        </div>
                    </div>
                </div>

                <!-- Time Travel -->
                <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-2xl font-bold text-center">2. æ—¶é—´æ—…è¡Œä¸ç‰ˆæœ¬åŒ–æŸ¥è¯¢</h3>
                    <p class="text-center text-sm mt-2 text-slate-500">æŸ¥è¯¢æ•°æ®åœ¨è¿‡å»ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹çš„å†å²å¿«ç…§ã€‚</p>
                    <div class="mt-6">
                        <div class="w-full bg-slate-800 text-white p-4 rounded-lg font-mono text-xs overflow-x-auto">
                            <span class="text-purple-400">SELECT</span> o.*, u.city<br>
                            <span class="text-purple-400">FROM</span> orders o <span class="text-purple-400">JOIN</span> user_info u<br>
                            <span class="text-yellow-300">FOR SYSTEM_TIME AS OF</span> o.proc_time<br>
                            <span class="text-purple-400">ON</span> o.user_id = u.user_id;
                        </div>
                        <div class="mt-4">
                            <p class="text-center font-semibold mb-2">æ—¶é—´çº¿</p>
                            <div class="relative flex justify-between items-center w-full bg-slate-200 h-1 rounded-full">
                                <button data-time="t1" class="time-travel-btn absolute w-4 h-4 bg-white border-2 border-sky-500 rounded-full cursor-pointer" style="left: 10%;"></button>
                                <button data-time="t2" class="time-travel-btn absolute w-4 h-4 bg-white border-2 border-slate-400 rounded-full cursor-pointer" style="left: 50%;"></button>
                                <button data-time="t3" class="time-travel-btn absolute w-4 h-4 bg-white border-2 border-slate-400 rounded-full cursor-pointer" style="left: 90%;"></button>
                            </div>
                            <div class="flex justify-between text-xs mt-2">
                                <span class="text-left">10:00</span>
                                <span class="text-center">10:10</span>
                                <span class="text-right">10:20</span>
                            </div>
                        </div>
                        <div id="time-travel-output" class="mt-4 p-4 bg-slate-50 rounded-md min-h-[80px]">
                           <!-- Output will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="paradigm-shift" class="py-20 text-center">
             <h2 class="text-3xl font-bold">æ€»ç»“ï¼šä¸€åœºæ•°æ®æ¶æ„çš„â€œèŒƒå¼è½¬ç§»â€</h2>
             <blockquote class="mt-6 max-w-3xl mx-auto text-lg italic text-slate-600 border-l-4 border-sky-500 pl-6">
                â€œFluss çš„å‡ºç°ï¼Œä¸ä»…ä»…æ˜¯æä¾›äº†ä¸€ä¸ªâ€˜æ›´å¿«çš„ Kafkaâ€™ï¼Œå®ƒä»£è¡¨äº†ä¸€ç§å…¨æ–°çš„æ•°æ®æ¶æ„æ€æƒ³ï¼šä»è¿‡å»ä¸ºäº†åº”å¯¹ä¸åŒéœ€æ±‚è€Œ**æ‹¼å‡‘**çš„ã€å¤æ‚çš„ã€æ•°æ®æ˜“åˆ†è£‚çš„å¤šä¸ªç³»ç»Ÿï¼Œè½¬å‘ä¸€ä¸ª**å†…èšçš„**ã€**ç®€åŒ–çš„**ã€**æ•°æ®åŸç”Ÿä¸€è‡´**çš„ç°ä»£åŒ–ç»Ÿä¸€å¹³å°ã€‚â€
             </blockquote>
             <p class="mt-6 text-slate-500">æŒæ¡ Fluss çš„æ ¸å¿ƒç†å¿µï¼Œæœ‰åŠ©äºæˆ‘ä»¬ç†è§£ç°ä»£å®æ—¶æ•°æ®å¤„ç†çš„å‘å±•æ–¹å‘ï¼Œå¹¶æ„å»ºå‡ºæ›´é«˜æ•ˆã€æ›´ç¨³å®šã€æ›´å¯ä¿¡çš„æ•°æ®äº§å“ã€‚</p>
        </section>

    </main>
    
    <footer class="bg-slate-800 text-slate-400 text-center p-4 text-sm">
        <p>äº¤äº’å¼å­¦ä¹ æŒ‡å— | çµæ„Ÿæºè‡ªæ‚¨çš„å­¦ä¹ ç¬”è®°</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // Navigation scroll highlighting
            const sections = document.querySelectorAll('main section');
            const navLinks = document.querySelectorAll('header nav a');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.toggle('active-nav', link.getAttribute('href').substring(1) === entry.target.id);
                        });
                    }
                });
            }, { rootMargin: "-50% 0px -50% 0px" });

            sections.forEach(section => {
                observer.observe(section);
            });

            // Tab functionality
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanels = document.querySelectorAll('.tab-panel');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;

                    tabButtons.forEach(btn => btn.classList.remove('active-tab'));
                    button.classList.add('active-tab');

                    tabPanels.forEach(panel => {
                        panel.style.display = panel.id === targetTab ? 'block' : 'none';
                    });
                });
            });

            // --- Projection Pushdown Chart ---
            const ppCtx = document.getElementById('projectionPushdownChart').getContext('2d');
            const ppKafkaBtn = document.getElementById('pp-kafka-btn');
            const ppFlussBtn = document.getElementById('pp-fluss-btn');
            const ppExplanation = document.getElementById('pp-explanation');
            let ppChart;

            const kafkaData = { transfer: 100, time: 85 };
            const flussData = { transfer: 2, time: 10 };

            function createOrUpdatePpChart(data) {
                if (ppChart) {
                    ppChart.data.datasets[0].data = [data.transfer];
                    ppChart.data.datasets[1].data = [data.time];
                    ppChart.update();
                } else {
                    ppChart = new Chart(ppCtx, {
                        type: 'bar',
                        data: {
                            labels: ['æŸ¥è¯¢æ€§èƒ½å¯¹æ¯”'],
                            datasets: [{
                                label: 'æ•°æ®ä¼ è¾“é‡ (MB)',
                                data: [data.transfer],
                                backgroundColor: 'rgba(56, 189, 248, 0.6)',
                                borderColor: 'rgba(56, 189, 248, 1)',
                                borderWidth: 1,
                                yAxisID: 'y'
                            }, {
                                label: 'æŸ¥è¯¢è€—æ—¶ (ms)',
                                data: [data.time],
                                backgroundColor: 'rgba(249, 115, 22, 0.6)',
                                borderColor: 'rgba(249, 115, 22, 1)',
                                borderWidth: 1,
                                yAxisID: 'y1'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    position: 'left',
                                    title: { display: true, text: 'æ•°æ®ä¼ è¾“é‡ (MB)' }
                                },
                                y1: {
                                    beginAtZero: true,
                                    position: 'right',
                                    title: { display: true, text: 'æŸ¥è¯¢è€—æ—¶ (ms)' },
                                    grid: { drawOnChartArea: false }
                                }
                            }
                        }
                    });
                }
            }
            
            ppKafkaBtn.addEventListener('click', () => {
                ppKafkaBtn.classList.add('bg-white', 'shadow');
                ppFlussBtn.classList.remove('bg-white', 'shadow');
                createOrUpdatePpChart(kafkaData);
                ppExplanation.textContent = 'åœ¨ Kafka æ¨¡å¼ä¸‹ï¼Œå³ä½¿æŸ¥è¯¢åªéœ€è¦2ä¸ªå­—æ®µï¼Œä¹Ÿå¿…é¡»ä¼ è¾“åŒ…å«100ä¸ªå­—æ®µçš„å…¨éƒ¨æ•°æ®ã€‚';
            });

            ppFlussBtn.addEventListener('click', () => {
                ppFlussBtn.classList.add('bg-white', 'shadow');
                ppKafkaBtn.classList.remove('bg-white', 'shadow');
                createOrUpdatePpChart(flussData);
                ppExplanation.textContent = 'åœ¨ Fluss æ¨¡å¼ä¸‹ï¼Œå­˜å‚¨å±‚å®Œæˆåˆ—è£å‰ªï¼Œåªä¼ è¾“æŸ¥è¯¢æ‰€éœ€çš„2ä¸ªå­—æ®µï¼Œç½‘ç»œå¼€é”€å’Œè€—æ—¶å¤§å¹…é™ä½ã€‚';
            });
            createOrUpdatePpChart(kafkaData);


            // --- Flink Join Diagram ---
            const joinFlinkBtn = document.getElementById('join-flink-btn');
            const joinFlussBtn = document.getElementById('join-fluss-btn');
            const joinDiagramContainer = document.getElementById('join-diagram-container');

            const flinkStateDiagram = `
                <div class="text-center w-full">
                    <div class="flex justify-around items-start">
                        <div class="font-semibold">è®¢å•æµ</div>
                        <div class="font-semibold">ç”¨æˆ·æµ</div>
                    </div>
                    <div class="flex justify-around items-start">
                        <div>â†“</div>
                        <div>â†“</div>
                    </div>
                    <div class="relative bg-sky-100 border-2 border-sky-300 p-4 rounded-lg w-64 mx-auto">
                        <p class="font-bold">Flink Job</p>
                        <div class="mt-2 bg-red-200 border border-red-400 p-3 rounded-md">
                            <p class="text-sm font-semibold text-red-700">å¤§çŠ¶æ€ (State)</p>
                            <p class="text-xs text-red-600">(ç¼“å­˜å…¨é‡ç”¨æˆ·æ•°æ®)</p>
                        </div>
                    </div>
                    <div class="mt-2">â†“</div>
                    <div class="font-semibold">Join ç»“æœ</div>
                    <p class="text-xs text-slate-500 mt-2">çŠ¶æ€ç®¡ç†åœ¨Flinkå†…éƒ¨ï¼Œèµ„æºæ¶ˆè€—å¤§ï¼Œç¨³å®šæ€§å—æŒ‘æˆ˜ã€‚</p>
                </div>
            `;

            const flussLookupDiagram = `
                <div class="text-center w-full flex items-center justify-center gap-8">
                    <div>
                       <div class="font-semibold">è®¢å•æµ</div>
                       <div>â†“</div>
                       <div class="bg-green-100 border-2 border-green-300 p-4 rounded-lg">
                           <p class="font-bold">Flink Job (è¿‘æ— çŠ¶æ€)</p>
                       </div>
                       <div>â†“</div>
                       <div class="font-semibold">Join ç»“æœ</div>
                    </div>
                    <div class="text-sm font-mono text-slate-500">âŸ· <br>Lookup<br>Join</div>
                    <div>
                       <div class="bg-green-100 border-2 border-green-300 p-4 rounded-lg">
                           <p class="font-bold">Fluss</p>
                           <p class="text-sm">ç”¨æˆ·è¡¨</p>
                       </div>
                       <p class="text-xs text-slate-500 mt-2">çŠ¶æ€ä¸‹æ”¾åˆ°Flussï¼ŒFlinkæ›´è½»é‡ã€ç¨³å®šã€‚</p>
                    </div>
                </div>
            `;
            
            function setJoinDiagram(type) {
                if(type === 'flink') {
                    joinFlinkBtn.classList.add('bg-white', 'shadow');
                    joinFlussBtn.classList.remove('bg-white', 'shadow');
                    joinDiagramContainer.innerHTML = flinkStateDiagram;
                } else {
                    joinFlussBtn.classList.add('bg-white', 'shadow');
                    joinFlinkBtn.classList.remove('bg-white', 'shadow');
                    joinDiagramContainer.innerHTML = flussLookupDiagram;
                }
            }
            
            joinFlinkBtn.addEventListener('click', () => setJoinDiagram('flink'));
            joinFlussBtn.addEventListener('click', () => setJoinDiagram('fluss'));
            setJoinDiagram('flink');

            // --- Stream-Table Duality Animation ---
            const playDualityBtn = document.getElementById('play-duality-btn');
            const streamEl = document.getElementById('stream-events');
            const tableEl = document.getElementById('table-state');

            const events = [
                { op: 'INSERT', key: 'user_A', value: '{ city: "åŒ—äº¬" }' },
                { op: 'INSERT', key: 'user_B', value: '{ city: "ä¸Šæµ·" }' },
                { op: 'UPDATE', key: 'user_A', value: '{ city: "æ·±åœ³" }' },
                { op: 'DELETE', key: 'user_B', value: null },
                { op: 'INSERT', key: 'user_C', value: '{ city: "å¹¿å·" }' },
            ];

            function resetDuality() {
                streamEl.innerHTML = '';
                tableEl.innerHTML = '';
            }

            playDualityBtn.addEventListener('click', () => {
                resetDuality();
                playDualityBtn.disabled = true;
                let tableState = {};
                let i = 0;

                function processNextEvent() {
                    if (i >= events.length) {
                        playDualityBtn.disabled = false;
                        return;
                    }
                    const event = events[i];
                    
                    // Add to stream
                    const streamItem = document.createElement('li');
                    streamItem.className = 'p-1 bg-white rounded shadow-sm';
                    streamItem.innerHTML = `<span class="font-mono text-xs ${event.op === 'INSERT' ? 'text-green-600' : event.op === 'UPDATE' ? 'text-blue-600' : 'text-red-600'}">${event.op}</span>: ${event.key}`;
                    streamEl.appendChild(streamItem);
                    streamEl.scrollTop = streamEl.scrollHeight;

                    // Update table
                    if (event.op === 'DELETE') {
                        delete tableState[event.key];
                    } else {
                        tableState[event.key] = event.value;
                    }
                    
                    tableEl.innerHTML = '';
                    for (const key in tableState) {
                        const tableItem = document.createElement('div');
                        tableItem.className = 'p-1 bg-white rounded shadow-sm font-mono text-xs';
                        tableItem.innerHTML = `<strong>${key}</strong>: ${tableState[key]}`;
                        tableEl.appendChild(tableItem);
                    }

                    i++;
                    setTimeout(processNextEvent, 800);
                }
                processNextEvent();
            });

            // --- Time Travel ---
            const timeTravelBtns = document.querySelectorAll('.time-travel-btn');
            const timeTravelOutput = document.getElementById('time-travel-output');
            
            const timeData = {
                t1: { time: '10:05', order: 'order_1', city: 'åŒ—äº¬', desc: 'åœ¨ 10:00ï¼Œç”¨æˆ·AåŸå¸‚æ›´æ–°ä¸ºåŒ—äº¬ã€‚åœ¨ 10:05ï¼Œè®¢å•å…³è”åˆ°å½“æ—¶çš„çŠ¶æ€ã€‚' },
                t2: { time: '10:10', order: 'â€”', city: 'ä¸Šæµ·', desc: 'åœ¨ 10:10ï¼Œç”¨æˆ·AåŸå¸‚æ›´æ–°ä¸ºä¸Šæµ·ã€‚è¿™æ˜¯ç»´åº¦æ•°æ®å˜æ›´çš„æ—¶åˆ»ã€‚' },
                t3: { time: '10:15', order: 'order_2', city: 'ä¸Šæµ·', desc: 'åœ¨ 10:15ï¼Œæ–°è®¢å•å…³è”åˆ°æœ€æ–°çš„ç”¨æˆ·çŠ¶æ€â€œä¸Šæµ·â€ã€‚' }
            };

            function updateTimeTravelView(timeKey) {
                timeTravelBtns.forEach(b => b.classList.remove('border-sky-500', 'ring-2', 'ring-sky-300'));
                timeTravelBtns.forEach(b => b.classList.add('border-slate-400'));

                const activeBtn = document.querySelector(`.time-travel-btn[data-time="${timeKey}"]`);
                activeBtn.classList.remove('border-slate-400');
                activeBtn.classList.add('border-sky-500', 'ring-2', 'ring-sky-300');
                
                const data = timeData[timeKey];
                timeTravelOutput.innerHTML = `
                    <p class="font-semibold">æ—¶é—´ç‚¹: <span class="font-mono">${data.time}</span></p>
                    <p class="text-sm mt-1">å…³è”è®¢å•: <span class="font-mono">${data.order}</span></p>
                    <p class="text-sm mt-1">å…³è”åŸå¸‚: <strong class="font-mono text-sky-600">${data.city}</strong></p>
                    <p class="text-xs mt-2 text-slate-500">${data.desc}</p>
                `;
            }

            timeTravelBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    updateTimeTravelView(btn.dataset.time);
                });
            });

            updateTimeTravelView('t1'); // Initial state
        });
    </script>
</body>
</html>
